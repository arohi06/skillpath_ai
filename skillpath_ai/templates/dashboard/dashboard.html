{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
</head>

<body>

  <!-- ================= WELCOME / DASHBOARD ================= -->
  <div class="dashboard" id="welcomePage">
    <h2> Welcome to the Pixie Forest! </h2>
    <hr>
    <h2></h2>
    <h3>In this magical land of pixels, we'll work on easing your mind from the overwhelming question that might be
      weighing upon your mind : "How do I upskill myself?"
      <br>
      But you needn't worry, stay with us through this short snippet of what might be your journey ahead
      <br>
      All the very best :)
    </h3>


    {% if roadmap and not roadmap.error %}
    <div class="button">
      <button class="button1" onclick="openLevel('level_1')">
        Ready to Level Up?
      </button>
    </div>
    {% endif %}

  </div>

  <!-- ===== LOGIN AND EDIT SKILL ACTIONS ===== -->
  <div class="modal-buttons">

    <a href="{% url 'skill_form:form' %}">
      <button class="button1">Edit Skills</button>
    </a>

    
    <a href="{% url 'login_user:login' %}">
      <button class="button1">Logout</button>
    </a>

  </div>

  <!-- ================= LEVEL MODALS ================= -->

  {% if roadmap and not roadmap.error %}
  {% for level, data in roadmap.items %}
  <div id="{{ level }}Modal" class="pixel-modal hidden">

    <div class="pixel-modal-content">

      <h2 id="level-head">
        LEVEL {{ forloop.counter }}
      </h2>

      <h2>{{ data.title }}</h2>
      <h3>{{ data.goal }}</h3>

      {% if data.skills %}
      <div>
        <strong>Skills You'll Learn:</strong>
        <ul>
          {% for skill in data.skills %}
          <li>{{ skill }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {% if data.tasks %}
      <div>
        <strong>Tasks:</strong>
        <ul>
          {% for task in data.tasks %}
          <li>{{ task }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {% if data.project %}
      <p><strong>Project:</strong><br>{{ data.project }}</p>
      {% endif %}

      {% if data.resources %}
      <div>
        <strong>Resources:</strong>
        <ul>
          {% for resource in data.resources %}
          <li>{{ resource }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {% if data.outcome %}
      <p><strong>Outcome:</strong><br>{{ data.outcome }}</p>
      {% endif %}

      <!-- ================= NAV BUTTONS ================= -->
      <div class="modal-buttons">

        <!-- BACK TO WELCOME (LEVEL 1 ONLY) -->
        {% if forloop.first %}
        <button class="button1" onclick="goToWelcome()">Back</button>
        {% endif %}

        <!-- BACK TO PREVIOUS LEVEL -->
        {% if not forloop.first %}
        <button class="button1" onclick="openLevel('level_{{ forloop.counter|add:-1 }}')">
          back
        </button>
        {% endif %}


        <!-- NEXT LEVEL -->
        {% if not forloop.last %}
        <button class="button1" onclick="openLevel('level_{{ forloop.counter|add:1 }}')">
          Ready for more?
        </button>
        {% endif %}

        

        {% if forloop.last %}
        <button class="button1" onclick="goToWelcome()">welcome page</button>
        {% endif %}

      </div>

    </div>
  </div>
  {% endfor %}
  {% endif %}

  <!-- ================= JS ================= -->
  <script>
    function openLevel(levelId) {
      document.querySelectorAll('.pixel-modal')
        .forEach(m => m.classList.add('hidden'));

      const modal = document.getElementById(levelId + 'Modal');
      if (modal) modal.classList.remove('hidden');
    }

    function goToWelcome() {
      document.querySelectorAll('.pixel-modal')
        .forEach(m => m.classList.add('hidden'));
    }
  </script>

</body>

</html>